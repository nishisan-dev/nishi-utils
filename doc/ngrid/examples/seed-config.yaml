# Configuracao completa para um Seed Node (Lider/Server)
# Este no define as politicas do cluster e serve como ponto de entrada.

node:
  id: "seed-1"            # ID fixo para o seed
  host: "10.0.0.1"        # Endereco IP acessivel pelos outros nos
  port: 9000              # Porta TCP
  roles:
    - "SEED"
    - "COORDINATOR"
  dirs:
    base: "/var/lib/ngrid/seed-1"

# Configuracoes de Autodiscover (Server Side)
# Habilita este no a responder requisicoes de configuracao
autodiscover:
  enabled: false          # O seed ja tem a config, entao false para client-mode
  secret: "my-cluster-secret-token-2026" # Segredo compartilhado

# Politicas Globais do Cluster (serao enviadas para novos nos)
cluster:
  name: "production-cluster"
  replication:
    factor: 3             # Replicar dados em 3 nos
    strict: true          # Exigir quorum estrito (CP)
  transport:
    workers: 4            # Threads de IO
  seeds:                  # Lista de seeds para failover
    - "10.0.0.1:9000"
    - "10.0.0.2:9000"

# Configuracao de Filas (multi-queue)
queues:
  - name: "global-events"
    retention:
      policy: "TIME_BASED"  # Modo Stream (Log Distribuido)
      duration: "48h"       # Rete mensagens por 48 horas
    performance:
      fsync: true           # Durabilidade maxima
      memory-buffer:
        enabled: true
        size: 10000
      short-circuit: false  # Forca persistencia antes da entrega
    compaction:
      threshold: 0.5
      interval: "30m"

  - name: "jobs"
    retention:
      policy: "DELETE_ON_CONSUME"

# Definicao de Mapas Persistentes
maps:
  - name: "user-sessions"
    key-type: "java.lang.String"
    value-type: "java.lang.String"
    persistence: "DISABLED" # Apenas memoria (rapido)
  
  - name: "product-inventory"
    persistence: "ASYNC_WITH_FSYNC" # Persistido em disco
